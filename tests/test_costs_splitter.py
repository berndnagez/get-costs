from src.get_costs import costs_splitter

def test_split():
    project_list = [
        {'project_id': '0026_comM', 'project_hours': '20.0', 'ID': '1004', 'Name': 'Björn Nagel', 'Wochenstd': '24', 'St.Brutto - Steuerbrutto': '2297.29', 'BezPausch - Pauschal versteuerte Bezüge': '0', 'U1 - Umlage 1': '55.13', 'U2 - Umlage 2': '8.96', 'InsoU - Insolvenzgeldumlage': '1.38', 'KV-AG-Beitrag': '187.23', 'RV-AG-Beitrag': '213.65', 'AV-AG-Beitrag': '29.86', 'PV-AG-Beitrag': '39.05', 'bAV AG-Anteil': '75.0', 'HVV': 'nan', '1&1': 'nan', 'Wetell': 'nan', 'Edenred': '-50.0', 'Urban Sports': 'nan', 'AU-Erstattung': '237.23'},
        {'project_id': '0054_comBüse', 'project_hours': '4.0', 'ID': '1004', 'Name': 'Björn Nagel', 'Wochenstd': '24', 'St.Brutto - Steuerbrutto': '2297.29', 'BezPausch - Pauschal versteuerte Bezüge': '0', 'U1 - Umlage 1': '55.13', 'U2 - Umlage 2': '8.96', 'InsoU - Insolvenzgeldumlage': '1.38', 'KV-AG-Beitrag': '187.23', 'RV-AG-Beitrag': '213.65', 'AV-AG-Beitrag': '29.86', 'PV-AG-Beitrag': '39.05', 'bAV AG-Anteil': '75.0', 'HVV': 'nan', '1&1': 'nan', 'Wetell': 'nan', 'Edenred': '-50.0', 'Urban Sports': 'nan', 'AU-Erstattung': '237.23'},
        {'project_id': '0005_Präv', 'project_hours': '7.0', 'ID': '1032', 'Name': 'Alan Roberts', 'Wochenstd': '40', 'St.Brutto - Steuerbrutto': '3675.67', 'BezPausch - Pauschal versteuerte Bezüge': '0', 'U1 - Umlage 1': '124.97', 'U2 - Umlage 2': '15.81', 'InsoU - Insolvenzgeldumlage': '2.21', 'KV-AG-Beitrag': '297.36', 'RV-AG-Beitrag': '341.84', 'AV-AG-Beitrag': '47.78', 'PV-AG-Beitrag': '62.49', 'bAV AG-Anteil': '150.0', 'HVV': '-46.55', '1&1': '-7.99', 'Wetell': 'nan', 'Edenred': '-50.0', 'Urban Sports': 'nan', 'AU-Erstattung': 'nan'},
        {'project_id': '0009_Talk about ', 'project_hours': '13.0', 'ID': '1032', 'Name': 'Alan Roberts', 'Wochenstd': '40', 'St.Brutto - Steuerbrutto': '3675.67', 'BezPausch - Pauschal versteuerte Bezüge': '0', 'U1 - Umlage 1': '124.97', 'U2 - Umlage 2': '15.81', 'InsoU - Insolvenzgeldumlage': '2.21', 'KV-AG-Beitrag': '297.36', 'RV-AG-Beitrag': '341.84', 'AV-AG-Beitrag': '47.78', 'PV-AG-Beitrag': '62.49', 'bAV AG-Anteil': '150.0', 'HVV': '-46.55', '1&1': '-7.99', 'Wetell': 'nan', 'Edenred': '-50.0', 'Urban Sports': 'nan', 'AU-Erstattung': 'nan'},
        {'project_id': '0026_comM', 'project_hours': '20.0', 'ID': '1032', 'Name': 'Alan Roberts', 'Wochenstd': '40', 'St.Brutto - Steuerbrutto': '3675.67', 'BezPausch - Pauschal versteuerte Bezüge': '0', 'U1 - Umlage 1': '124.97', 'U2 - Umlage 2': '15.81', 'InsoU - Insolvenzgeldumlage': '2.21', 'KV-AG-Beitrag': '297.36', 'RV-AG-Beitrag': '341.84', 'AV-AG-Beitrag': '47.78', 'PV-AG-Beitrag': '62.49', 'bAV AG-Anteil': '150.0', 'HVV': '-46.55', '1&1': '-7.99', 'Wetell': 'nan', 'Edenred': '-50.0', 'Urban Sports': 'nan', 'AU-Erstattung': 'nan'},
        {'project_id': '0026_comM', 'project_hours': '20.0', 'ID': '1028', 'Name': 'Birthe', 'Wochenstd': '40', 'St.Brutto - Steuerbrutto': '0.0', 'BezPausch - Pauschal versteuerte Bezüge': '533', 'U1 - Umlage 1': '124.97', 'U2 - Umlage 2': '15.81', 'InsoU - Insolvenzgeldumlage': '2.21', 'KV-AG-Beitrag': '297.36', 'RV-AG-Beitrag': '341.84', 'AV-AG-Beitrag': '47.78', 'PV-AG-Beitrag': '62.49', 'bAV AG-Anteil': '150.0', 'HVV': '-46.55', '1&1': '-7.99', 'Wetell': 'nan', 'Edenred': '-50.0', 'Urban Sports': 'nan', 'AU-Erstattung': 'nan'},
        {'project_id': '0026_comM', 'project_hours': '10.0', 'ID': '1035', 'Name': 'Paul Thiessen', 'Wochenstd': '20', 'St.Brutto - Steuerbrutto': '3675.67', 'BezPausch - Pauschal versteuerte Bezüge': '0', 'U1 - Umlage 1': '124.97', 'U2 - Umlage 2': '15.81', 'InsoU - Insolvenzgeldumlage': '2.21', 'KV-AG-Beitrag': '297.36', 'RV-AG-Beitrag': '341.84', 'AV-AG-Beitrag': '47.78', 'PV-AG-Beitrag': '62.49', 'bAV AG-Anteil': '150.0', 'HVV': '-46.55', '1&1': '-7.99', 'Wetell': 'nan', 'Edenred': '-50.0', 'Urban Sports': 'nan', 'AU-Erstattung': 'nan'},
        {'project_id': '0002_amb. TG ', 'project_hours': '25.0', 'ID': '1156', 'Name': 'Nels Wieschebrook', 'Wochenstd': '25.0', 'St.Brutto - Steuerbrutto': None, 'BezPausch - Pauschal versteuerte Bezüge': None, 'U1 - Umlage 1': None, 'U2 - Umlage 2': None, 'InsoU - Insolvenzgeldumlage': None, 'KV-AG-Beitrag': None, 'RV-AG-Beitrag': None, 'AV-AG-Beitrag': None, 'PV-AG-Beitrag': None, 'bAV AG-Anteil': None, 'HVV': 'nan', '1&1': '-19.99', 'Wetell': 'nan', 'Edenred': 'nan', 'Urban Sports': 'nan', 'AU-Erstattung': 'nan'}
        ]

    expected_splitted_values_list = [
        {'project_id': '0026_comM', 'staff_id': '1004', 'project_hours': '20.0', 'Gehalt': '=ROUND(2297.29/24*20.0, 2)', 'Sozialv.': '=ROUND(469.79/24*20.0, 2)', 'U1': '=ROUND(55.13/24*20.0, 2)', 'U2': '=ROUND(8.96/24*20.0, 2)', 'InsoU': '=ROUND(1.38/24*20.0, 2)', 'bAV': '=ROUND(75.0/24*20.0, 2)', 'AU-Erstattung': '=ROUND(237.23/24*20.0, 2)'},
        {'project_id': '0054_comBüse', 'staff_id': '1004', 'project_hours': '4.0', 'Gehalt': '=ROUND(2297.29/24*4.0, 2)', 'Sozialv.': '=ROUND(469.79/24*4.0, 2)', 'U1': '=ROUND(55.13/24*4.0, 2)', 'U2': '=ROUND(8.96/24*4.0, 2)', 'InsoU': '=ROUND(1.38/24*4.0, 2)', 'bAV': '=ROUND(75.0/24*4.0, 2)', 'AU-Erstattung': '=ROUND(237.23/24*4.0, 2)'},
        {'project_id': '0005_Präv', 'staff_id': '1032', 'project_hours': '7.0', 'Gehalt': '=ROUND(3675.67/40*7.0, 2)', 'Sozialv.': '=ROUND(749.47/40*7.0, 2)', 'U1': '=ROUND(124.97/40*7.0, 2)', 'U2': '=ROUND(15.81/40*7.0, 2)', 'InsoU': '=ROUND(2.21/40*7.0, 2)', 'bAV': '=ROUND(150.0/40*7.0, 2)', 'HVV': '=ROUND(46.55/40*7.0, 2)', '1&1': '=ROUND(7.99/40*7.0, 2)'},
        {'project_id': '0009_Talk about ', 'staff_id': '1032', 'project_hours': '13.0', 'Gehalt': '=ROUND(3675.67/40*13.0, 2)', 'Sozialv.': '=ROUND(749.47/40*13.0, 2)', 'U1': '=ROUND(124.97/40*13.0, 2)', 'U2': '=ROUND(15.81/40*13.0, 2)', 'InsoU': '=ROUND(2.21/40*13.0, 2)', 'bAV': '=ROUND(150.0/40*13.0, 2)', 'HVV': '=ROUND(46.55/40*13.0, 2)', '1&1': '=ROUND(7.99/40*13.0, 2)'},
        {'project_id': '0026_comM', 'staff_id': '1032', 'project_hours': '20.0', 'Gehalt': '=ROUND(3675.67/40*20.0, 2)', 'Sozialv.': '=ROUND(749.47/40*20.0, 2)', 'U1': '=ROUND(124.97/40*20.0, 2)', 'U2': '=ROUND(15.81/40*20.0, 2)', 'InsoU': '=ROUND(2.21/40*20.0, 2)', 'bAV': '=ROUND(150.0/40*20.0, 2)', 'HVV': '=ROUND(46.55/40*20.0, 2)', '1&1': '=ROUND(7.99/40*20.0, 2)'},
        {'project_id': '0026_comM', 'staff_id': '1028', 'project_hours': '20.0', 'Gehalt': '=1575.46*32.34%'},
        {'project_id': '0026_comM', 'staff_id': '1035', 'project_hours': '10.0', 'Gehalt': '=ROUND(4764.680000000001/20*10, 2)*32.34%'},
        {'project_id': '0002_amb. TG ', 'staff_id': '1156', 'project_hours': '25.0', 'Gehalt': 0.0, 'Sozialv.': '=ROUND(0.0/25.0*25.0, 2)', 'U1': 0.0, 'U2': 0.0, 'InsoU': 0.0, 'bAV': 0.0, '1&1': '=ROUND(19.99/25.0*25.0, 2)'}
        ]
    # Gehalt 1028 vorher: 899.47
    # Gehalt 1035vorher: 4621.6900000000005
    # TODO was ist jetzt richtig? Welche Werte würde ich per Hand ausrechnen, woher kommt die Differenz?

    returned_splitted_values_list = costs_splitter.split(project_list, projects=False)

    assert expected_splitted_values_list == returned_splitted_values_list